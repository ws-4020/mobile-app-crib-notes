---
title: REST APIå‘¼ã³ã ã—ä¸­ã®è¡¨ç¤º
---

REST APIã®å‘¼ã³ã ã—ã«ã¯å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚‹ã‚‚ã®ã§ã™ã€‚å‘¼ã³ã ã—ä¸­ã«ä½•ã‚‚ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿”ã•ãªã„ã¨ã€ã‚¢ãƒ—ãƒªã§å‡¦ç†ä¸­ãªã®ã‹ã€è‡ªåˆ†ã®æ“ä½œãŒä¼ã‚ã£ã¦ã„ãªã„ã®ã‹ã€ãƒ¦ãƒ¼ã‚¶ã«ã¯åˆ¤æ–­ã§ããªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ãã®ãŸã‚ã€REST APIã®å‘¼ã³ã ã—ä¸­ã¯ã€ã‚¢ãƒ—ãƒªãŒå‡¦ç†ä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ãƒ¦ãƒ¼ã‚¶ã«ä¼ãˆã‚‹ã®ãŒæœ›ã¾ã—ã„ã§ã™ã€‚

ã¾ãŸã€å‰Šé™¤ã—ãŸToDoã®ç·¨é›†ãªã©ã€REST APIã§ã®å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§ãƒ–ãƒ­ãƒƒã‚¯ã—ãŸã„æ“ä½œã‚‚ã‚ã‚Šã¾ã™ã€‚

ToDoã‚¢ãƒ—ãƒªã§ã¯ã€REST APIã®å‘¼ã³ã ã—ä¸­ã¯ToDoä¸€è¦§ä¸Šã«ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ä¼ãˆã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã¾ãŸã€ToDoä¸€è¦§å†…ã§ã®å®Œäº†ã‚„ç·¨é›†ãªã©ã®æ“ä½œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚

ã“ã‚Œã‹ã‚‰å­¦ç¿’ã—ã¦å®Ÿè£…ã—ã¦è¡¨ç¾ã™ã‚‹ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­çŠ¶æ…‹ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

![Image](../app-hands-on/ios-wait.png)

## REST APIã®å‘¼ã³ã ã—çŠ¶æ…‹ã®ç®¡ç†

ã¾ãšã€REST APIã‚’å‘¼ã³ã ã™ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã€REST APIã‚’å‘¼ã³ã ã—ä¸­ã‹ã©ã†ã‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚çŠ¶æ…‹ã®ç®¡ç†ã«ã¯ã€Reactã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
å‡¦ç†ä¸­ã‚’`true`ã€‚å‡¦ç†æ¸ˆã‚’`false`ã¨ã—ã¦REST APIã®å‘¼ã³ã ã—çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚

ä¿®æ­£é‡ãŒå¤šã„ã®ã§ã€æ¬¡ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã§`TodoBoard.tsx`ã‚’ä¸Šæ›¸ãã—ã¦ãã ã•ã„ã€‚

```typescript jsx title="/src/screens/todo/TodoBoard.tsx"
import {useFocusEffect} from '@react-navigation/native';
import {FilterType, TodoFilter, TodoList} from 'components/parts';
import {useTodoStackNavigation} from 'navigation/hooks';
import React, {useCallback, useContext, useState} from 'react';
import {Alert, StyleSheet, View} from 'react-native';
import {Icon, ThemeContext} from 'react-native-elements';
import {Todo, TodoService, ErrorObject} from 'services';

type ShowFilter = {
  [K in FilterType]: (todo: Todo) => boolean;
};

const showFilter: ShowFilter = {
  [FilterType.ALL]: () => true,
  [FilterType.INCOMPLETE]: (todo) => !todo.completed,
  [FilterType.COMPLETED]: (todo) => todo.completed,
};

export const TodoBoard: React.FC = () => {
  const {theme} = useContext(ThemeContext);
  const navigation = useTodoStackNavigation<'TodoBoard'>();
  const [todos, setTodos] = useState<Todo[]>();
  const [filterType, setFilterType] = useState<FilterType>(FilterType.ALL);
  const [loading, setLoading] = useState(false);

  useFocusEffect(
    useCallback(() => {
      let isActive = true;
      setLoading(true);

      TodoService.getTodos()
        .then((response) => {
          if (isActive) {
            setTodos(response);
          }
        })
        .catch((e: ErrorObject) => {
          console.log(e.message);
        })
        .finally(() => {
          if (isActive) {
            setLoading(false);
          }
        });

      return () => {
        isActive = false;
      };
    }, []),
  );

  const toggleTodoCompletion = useCallback(
    (id: number) => {
      if (todos === undefined) {
        return;
      }
      const target = todos.find((todo) => todo.id === id);
      if (!target) {
        return;
      }
      /*
       * Networkè¶Šã—ã®å‡¦ç†æ™‚é–“ã‚’å¾…ãŸãšã«UIã‚’æ›´æ–°ã™ã‚‹ã€‚
       * å‡¦ç†ãŒæ­£å¸¸ã«å‡ºæ¥ãªã„å ´åˆã¯æˆ»ã™ãŒã€ãƒªã‚½ãƒ¼ã‚¹ï¼ˆã‚¿ã‚¹ã‚¯ï¼‰ãŒãªããªã£ã¦ã„ã‚‹å ´åˆã¯å‰Šé™¤ã™ã‚‹ã€‚
       */
      setTodos(todos.map((todo) => (todo.id === id ? {...todo, completed: !target.completed} : todo)));
      TodoService.putTodo(id, !target.completed).catch((e: ErrorObject) => {
        if (e.status && e.status === 404) {
          setTodos(todos.filter((todo) => todo.id !== id));
          console.log(`æ›´æ–°ã—ã‚ˆã†ã¨ã—ãŸã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚`);
        } else {
          // errorã§å‡¦ç†ã§ããªã‘ã‚Œã°æˆ»ã™
          setTodos(todos.map((todo) => (todo.id === id ? {...todo, completed: target.completed} : todo)));
          console.log(e.message);
        }
      });
    },
    [todos],
  );

  const showTodos = todos?.filter(showFilter[filterType]);

  return (
    <View style={styles.container} testID="screen/main/home">
      <TodoFilter filterType={filterType} setFilterType={setFilterType} />
      <TodoList
        todos={showTodos}
        contentContainerStyle={styles.todoListContainer}
        toggleTodoCompletion={toggleTodoCompletion}
      />
      <Icon
        name="plus"
        type="font-awesome-5"
        color={theme.colors?.primary}
        raised
        reverse
        size={30}
        containerStyle={styles.iconContainerStyle}
        onPress={() => {
          navigation.navigate('TodoForm');
        }}
      />
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
  },
  todoListContainer: {
    paddingLeft: 20,
    paddingRight: 20,
    paddingBottom: 80,
  },
  iconContainerStyle: {
    position: 'absolute',
    bottom: 10,
    right: 10,
  },
  indicatorContainer: {
    position: 'absolute',
    zIndex: 2,
    width: '100%',
    flex: 1,
    alignContent: 'center',
    height: '100%',
    backgroundColor: 'rgba(0, 0, 0, 0.2)',
  },
  indicator: {
    flex: 1,
  },
});
```

:::caution
ç¾æ™‚ç‚¹ã§ã¯ã€ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®å‡¦ç†ã¯å®Ÿè£…ã—ã¾ã›ã‚“ãŒã€å®Ÿè£…ä¸­ã«ã©ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ãŸã„ã“ã¨ã¯å¤šã„ã®ã§ãƒ­ã‚°å‡ºåŠ›ã ã‘ã—ã¦ã„ã¾ã™ã€‚

æœ¬æ¥ã¯ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«ã¯ãƒ¦ãƒ¼ã‚¶ã«ã‚‚ã‚¨ãƒ©ãƒ¼ã®å†…å®¹ã¨ï¼ˆå¯èƒ½ã§ã‚ã‚Œã°ï¼‰ã‚¨ãƒ©ãƒ¼ã‹ã‚‰å›å¾©ã™ã‚‹æ–¹æ³•ã‚’ä¼ãˆã‚‹ã¹ãã§ã™ã€‚
:::

## ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã®è¡¨ç¤º

æ¬¡ã«ã€REST APIã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹é–“ã ã‘ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚ã“ã®ã¨ãã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ToDoä¸€è¦§ã®ä¸Šã«ã‹ã¶ã›ã¦è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ã€ToDoä¸€è¦§å†…ã§ã®ãƒ¦ãƒ¼ã‚¶ã®æ“ä½œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚

> ğŸš§ ä½œæˆä¸­ ğŸš§

<!--
TODO: ã‚¹ãƒ†ãƒ¼ãƒˆã‚’å‚ç…§ã—ã¦ã€è¡¨ç¤ºã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã¨ã€ä¸‹ã«é…ç½®ã™ã‚‹ã¨ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã‹ã‚‰æ“ä½œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã§ãã‚‹ã“ã¨ã‚’ä¼ãˆã‚‰ã‚Œã‚Œã°è‰¯ã„ã ã‚ã†ã‹ã€‚
-->

## å‹•ä½œç¢ºèª

ã“ã‚Œã§ã€ToDoä¸€è¦§å–å¾—ã®REST APIã‚’å‘¼ã³ã ã—ã¦ã„ã‚‹é–“ã¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã€ä¸€éƒ¨ã®æ“ä½œã¯ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚å®Ÿéš›ã«ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¦å‹•ãã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

ãŸã ã€APIã‚µãƒ¼ãƒã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã§èµ·å‹•ã—ã¦ã„ã‚‹å ´åˆãªã©ã¯ã€REST APIã‹ã‚‰ã®å¿œç­”ãŒæ—©ã„ãŸã‚ä¸€ç¬ã—ã‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ã“ã®çŠ¶æ…‹ã ã¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã®ç¢ºèªã¯é›£ã—ã„ã®ã§ã€ã¾ãšREST APIã‹ã‚‰ã®å¿œç­”ã«æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã‚‹çŠ¶æ³ã‚’æ“¬ä¼¼çš„ã«å†ç¾ã—ã¾ã™ã€‚

> ğŸš§ ä½œæˆä¸­ ğŸš§

<!--
TODO: ã“ã“ã§Middlewareã®è©±ã‚’ã—ã¦ã€APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é…å»¶ã•ã›ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã‚‹ã€‚
-->

ã“ã®ã‚ˆã†ã«ä¿®æ­£ã™ã‚‹ã¨ã€`TodoService`ã§ToDoä¸€è¦§ãªã©ã‚’å–å¾—ã™ã‚‹ã¾ã§ã«xxç§’ã‹ã‹ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãªã®ã§ã€ãã®é–“ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã€xxç§’çµŒã¤ã¨ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãŒæ¶ˆãˆã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

> ğŸš§ ä½œæˆä¸­ ğŸš§

<!--
TODO: å‹•ä½œç¢ºèªã®æ‰‹é †ã‚’ä½•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹æç¤ºã—ã¦ãŠãã®ãŒã„ã„ã‹ãªã€‚ã€Œã‚¢ãƒ—ãƒªèµ·å‹•å¾Œã€ã€Œã‚¿ãƒ–åˆ‡æ›¿æ™‚ã€ã€ŒToDoç™»éŒ²å¾Œã€ãã‚‰ã„ã§å……åˆ†ã‹ãªï¼Ÿ
-->
