---
title: メッセージ管理
---

Status: Accepted

<!--
Proposed: 提案中
Accepted: 採用
Rejected: 却下
Superseded: 廃止
-->

## 要約

:::note
ADRの決定事項を要約して、3行程度で記載してください。
:::

## コンテキスト

モバイルアプリのメッセージはバックエンドと違い、操作ガイダンスやエラーの文言などが利用者に直接表示されることが前提となっている。
これらは開発側の事情よりも、顧客や利用者の意図によって変わりやすいため、集中管理が必要となる。
集中管理することで、ハードコーディングの防止と、同一文言の集約や文体や体裁の統一を行いやすく、メンテナンス性が高まる。
また、サーバーでメッセージを管理しておき、アプリでロードして表示するような方式であれば文言の変更によるアプリの更新が不要となる。
管理が必要となる他の理由としては多言語対応がある。

ただし、上であげた理由よりも、小規模や限定的なメッセージ用途で初期開発の速度を求められる場合は、メッセージ管理をしないという選択もある。

:::note
この決定や変更をしなくてはいけない状況や問題などを説明してください。
:::

## 議論

### なぜ管理が必要になるのか？
モバイルアプリのメッセージは、ユーザーの目に触れやすくUI/UXの観点からも変わりやすい。
コードのメンテナンス性や文言の一意性から、集中管理をすると良い。一覧を抽出しやすいとより良い。

#### 管理するメッセージの候補は？
管理しなければならないメッセージの候補には以下のようなものがある。

1. 画面の表示項目などのラベル
2. ダイアログで表示するメッセージ
  - 確認や操作ガイダンスのダイアログやトースターでの情報通知
  - OS側で出すマイクやカメラの許可ダイアログのメッセージ
  - エラーメッセージ
  - プッシュ通知
    - リモート（サーバーからの）通知
    - ローカル（アプリからの）通知
3. APIのレスポンスに含まれている文言　
4. ログに出すメッセージ 

#### この方式で管理するメッセージ

1. 画面の表示項目などのラベル → 管理する
2. ダイアログで表示するメッセージ → 以下を管理する
  - 確認や操作ガイダンスのダイアログやトースターでの情報通知
  - エラーメッセージ
  - プッシュ通知
    - ローカル（アプリからの）通知
3. APIのレスポンスに含まれている文言 → ケースバイケースで管理する

カメラやマイク許可などのOS側の組み込みメッセージと、サーバーからのプッシュ通知を表示するリモート通知はモバイルアプリ開発の範囲外となるため含めない。
ログメッセージは通常ユーザーの目に触れないことと文言が頻繁に変わることから、開発効率を考えて管理対象外としている。
APIレスポンスに含まれている文言は、例えば、サーバーメンテナンスなどはそのまま表示すれば良い。
一方、残金不足でその金額がバックエンドからしか分からないような値を表示するにはレスポンス内のその金額だけを受け取って加工する場合もあれば、
やはりバックエンドが限定的にモバイルだけにしか使用されないならそのメッセージを加工なしで表示する場合もあり、ケースバイケースとした。

### 開発のしやすさ

キーを元にメッセージをロードするが、日本人開発者が多く日本語しか使わない場合は、日本語をキーとした方が画面コンポーネントやエラーなどで可読性が高まるはずである。
他、IDEでキーが補完されると良い。

## 決定

:::note
最終的な決定内容を記録してください
:::
