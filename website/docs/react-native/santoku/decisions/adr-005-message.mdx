---
title: メッセージ管理の方針
---

Status: Accepted

<!--
Proposed: 提案中
Accepted: 採用
Rejected: 却下
Superseded: 廃止
-->

## 要約

メッセージ管理に関する方針は以下とします。
- モバイルアプリの利用者の目に触れるメッセージは、一意なキーと文言や文章で管理する
- 開発しやすいようIDE補完が働くようキーを定義する
- 可読性が高まるよう日本語をキーとして良い

## コンテキスト

モバイルアプリのメッセージはバックエンドと違い、操作ガイダンスやエラーの文言などが利用者に直接表示されることが前提になっています。  
これらは開発側の事情よりも、顧客や利用者の意図によって変わりやすいため、集中管理が必要となります。  
集中管理することで、ハードコーディングの防止と、同一文言の集約や文体や体裁の統一を行いやすく、メンテナンス性が高まります。  
また、サーバーでメッセージを管理しておき、アプリでロードして表示するような方式であれば文言の変更によるアプリの更新が不要となります。  
管理が必要となる他の理由に、多言語対応もあります。

ただし、上であげた理由よりも、小規模や限定的なメッセージ用途で初期開発の速度を求められる場合は、メッセージ管理をしないという選択もあります。

## 議論

### なぜ管理が必要になるのか？
モバイルアプリのメッセージは、ユーザーの目に触れやすくUI/UXの観点からも変わりやすいものです。  
コードのメンテナンス性や文言の一意性から、集中管理が必要になります。  
メッセージ一覧は、UI/UX責任者と合意しやすいよう抽出できるとなお良いでしょう。  

#### 管理するメッセージの候補は？
管理しなければならないメッセージの候補には以下のようなものがあります。  

|メッセージ候補|例|
|:--|:--|
|画面のラベル|UI部品（ログイン画面）のラベル（アカウント、パスワード）など|
|ダイアログで表示するメッセージ|確認ダイアログ、操作ガイダンス、トースターの通知など|
|OSで出す許可ダイアログのメッセージ|カメラやマイクの許可など|
|エラーメッセージ|エラー発生時に表示するメッセージダイアログ|
|プッシュ通知（リモート）|サーバーからのプッシュ通知メッセージ|
|プッシュ通知（ローカル）|アプリからのプッシュ通知メッセージ|
|APIのレスポンス内の文言|レスポンスに含まれる文言（サーバーメンテナンス中、残金不足エラーの金額など）|
|ログに出すメッセージ|モバイルアプリ内のログメッセージ|

#### この方式で管理するメッセージ

|メッセージ候補|管理する・しない|
|:--|:--|
|画面のラベル|する|
|ダイアログで表示するメッセージ|する|
|OSで出す許可ダイアログのメッセージ|しない *1|
|エラーメッセージ|する|
|プッシュ通知（リモート）|しない（できない）*1|
|プッシュ通知（ローカル）|する|
|APIのレスポンス内の文言|ケースバイケース *2|
|ログに出すメッセージ|しない *3|

*1: カメラやマイク許可などのOS側の組み込みメッセージと、サーバーからのプッシュ通知を表示するリモート通知はモバイルアプリ開発の範囲外となるため含めない。  
*2: APIレスポンスに含まれている文言は、例えば、サーバーメンテナンスなどはそのまま表示すれば良い。  
一方、残金不足でその金額がバックエンドからしか分からないような値を表示するにはレスポンス内のその金額だけを受け取って加工する場合もあれば、
やはりバックエンドが限定的にモバイルだけにしか使用されないならそのメッセージを加工なしで表示する場合もあり、ケースバイケースとした。  
*3: ログメッセージは通常ユーザーの目に触れないことと文言が頻繁に変わることから、開発効率を考えて管理対象外としている。  

### 開発のしやすさ

キーを元にメッセージをロードするが、日本人開発者が多く日本語しか使わない場合は、日本語をキーとした方が画面コンポーネントやエラーなどで可読性が高まります。  
他、IDEでキーが補完されると良いでしょう。

## 決定

モバイルアプリのメッセージは、利用者の目に触れるものは可能な限り管理下に含み、集約化を行います。  
メッセージ管理コンポーネントは、IDEの補完が効くようなキーを定義しておき開発効率を良くします。  
UI部品（.jsx, .tsx）は、日本語をキーにして可読性を高めます。  