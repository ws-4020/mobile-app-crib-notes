---
title: 単体テスト計画
---

単体テストのテスト方針は以下のとおりです。

## テスト方針

| NO | カテゴリ | 内容 |
| --- | :--- | :--- |
| 1 | [テスト実施内容](#テスト実施内容) | テスト実施方法毎のテスト内容 |
| 2 | [エビデンス取得方針](#エビデンス取得方針) | エビデンスの取得方針 |
| 3 | [検証方針](#検証方針) | 単体テスト結果の検証方針 |
| 4 | [テスト環境](#テスト環境) | テストを実施するテスト環境 |
| 5 | [事前準備](#事前準備) | テスト実施前に必要となる準備事項とその準備内容 |

## テスト実施内容

テストは手動（打鍵）と自動の2種類を実施します。
それぞれのテスト方法毎の確認内容は以下のとおりです。

### 手動（打鍵）テストの実施内容

- 画面単位で関連する設計書と比較してレイアウトやイベントの動作を検証する
- API連携部分は、モックサーバと接続して、動作を検証する
- テスト観点表をベースにテスト対象の画面または機能を確認する観点を選定して、テスト仕様書を作成して動作を検証する

### 自動テスト

- テスト観点表をベースにテスト対象の画面または機能を確認する観点を選定して、テスト仕様書とテストコードを作成して動作を検証する
- テストコードは、C0/C1カバレッジが100%とるように作成する

## エビデンス取得方針

- エビデンスは基本取得しない。テストケースに対するテスト結果は、単体テスト仕様書に記載する
- 自動テストの結果を確認して、カバレッジが100%にならない場合は、その理由を単体テスト仕様書へ記載する

## 検証方針

- レビューイが単体テスト仕様書のテスト対象ケースの確認結果が全て、`〇`になっていることを確認する
- レビューイがカバレッジレポートを確認して、カバレッジが100%となっていることを確認する。カバレッジが100%となっていない場合、未達理由が妥当であることを確認する
- レビューアが単体テスト仕様書の内容について、テスト結果が妥当であることを確認する

## テスト環境

単体テストは、開発用PCのローカル環境で実施します。エミュレータ／シミュレータまたは実機で使用する機種とOSバージョンのバリエーションは、
[単体テスト環境](../all/test-environment#単体テスト環境)で、定義したものでテストを実施します。

## 事前準備

テスト実施前に以下のことを準備します。

### テストデータ

テスト実施に必要なデータパターンを洗い出し、パターンを網羅できるテストデータを作成する。

### エミュレータ／シミュレータの準備

テストで必要となるエミュレータとシミュレータの作成または、ダウンロードをします。

#### Androidエミュレータの作成

テストで使用する機種×OSバージョン分のエミュレータを以下の手順に沿って作成します。

1. Android Studio下部の`構成 ＞ AVDマネージャー ＞ 仮想デバイスの作成 ＞ 新規ハードウェア・プロファイルを選択
1. ハードウェア・プロファイルの構成画面にて、作成するのに必要な項目を以下に列挙。入力後に`完了`を選択
    - デバイス名：作成する機種名
    - デバイス・タイプ：Phone/Tablet
    - スクリーン：作成する機種の画面サイズ
1. 作成したデバイスを選択して、`次へ`を選択
1. OSバージョンを選択して、`次へ`を選択
1. `完了`を選択

### iOSシミュレータのダウンロード／追加

テストで使用する機種×OSバージョンが自身の環境に不足しているものを以下の手順でダウンロードまたは、追加します。

- OSバージョンのダウンロード

メニューバーの`Xcode > Preference`を開いて、`Components`タブを選択して、表示されているシミュレータの中から必要なものを選択して、ダウンロードする。

- 機種の追加

Xcodeでプロジェクトを開いた状態で、以下の流れで機種を追加します。

1. 上段に表示されている機種名を選択
1. `Add Additional Simulators`を選択
1. 左下の`+`を選択
1. 作成したい機種×OSバージョンを以下の項目へ設定して、`Create`を選択して作成
    - Simulator Name：作成したい機種の名称
    - Device Type：作成したい機種
    - OS Version：作成したい機種のOSバージョン

## エミュレータ／シミュレータの使用方法

### Androidエミュレータ

Android Studioを起動して、エミュレータの起動確認をします。

- エミュレータの起動

Android Studio下部の`構成 > AVDマネージャー > 起動したいエミュレータのアクション：▶`を押下して起動する。

### iOSシミュレータ

Xcodeを起動して、シミュレータの起動確認をします。

- シミュレータの起動

メニューバーの`Xcode > Open Developer Tool > Simulator`を選択して、シミュレータを起動する。

## スマートフォン実機使用方法

### iOS

- MacとiPhoneをUSBケーブルで接続する
- Mac側でXcodeを起動して、左上のDevice選択欄から接続したiPhoneを選択する
- iPhoneで`設定 > 一般 > プロファイルとデバイス管理（または、VPNとデバイス管理）`の中で`デベロッパApp`欄の`XXXX`[^1]を選択して、`XXXXを信頼`[^1]をタップして、`信頼`をタップ
- アプリ一覧のビルドしたアプリのアイコンをタップして動作を確認する

:::note
使用するiPhoneを初めてMacにUSB接続する場合、iPhone側へ`このコンピュータを信頼しますか？`のメッセージが表示されます。
メッセージに対して、`信頼`するを選択してください。その後、パスコード入力を求められるのでそちらも入力します。
:::

[^1]: `XXXX`はApple IDです。

### Android

- PCとAndroid端末をUSBケーブルで接続する
- Android端末側で`このデバイスをUSBで充電中`の通知をタップして、`USBの使用`の下で`ファイル転送`を選択する
- Android端末の設定画面を開いて、一番下の方に`端末情報`というメニューがあるのでタップする
- ビルド番号を7回タップする（`これでデベロッパーになりました！`と表示されればOK）
- 設定画面に戻り、`開発者向けオプション`というメニューが表れているのでそれをタップして、`ON`を有効にしてさらに`USBデバッグ`を有効にする
- PC側でAndroid Studioを起動して、実行ボタンを押下して、Android端末側で動作を確認する

### その他

#### Androidエミュレータのノッチ設定

Androidエミュレータでテストする際のノッチ有／無の設定方法です。
必要なタイミングで設定を変えてテストを実施します。

- ノッチ有の設定

1. ホーム画面で、下から上へスワイプして、アプリ一覧から`Settings`をタップする
1. 一覧から`About emulated device`をタップする
1. `Build number`を7回タップする
1. アプリ一覧から`System`をタップする
1. `Advance`をタップする
1. `Developer options`をタップする
1. `Display cutout`をタップして、`Tall cutout`をタップする

- ノッチ無の設定

1. ホーム画面で、下から上へスワイプして、アプリ一覧から`Settings`をタップする
1. 一覧から`About emulated device`をタップする
1. `Build number`を7回タップする
1. アプリ一覧から`System`をタップする
1. `Advance`をタップする
1. `Developer options`をタップする
1. `Display cutout`をタップして、`Device default`をタップする
