---
title: ディープリンクの受信
---

ディープリンクをアプリケーションが受信するタイミングは２つあります。ユーザがアプリを起動していない状態でディープリンクから起動した場合とアプリが起動中の場合です。

## アプリケーションの状態とURLの取得

アプリがURLを取得するための[API](https://rnfirebase.io/dynamic-links/usage#listening-for-dynamic-links)はディープリンクで起動した場合と起動にディープリンクを開いた場合があります。

どちらの場合でもURLパラメータを取得して、画面遷移の判定をした上でパラメータを処理します。

### ディープリンクで起動した場合の受信

ディープリンクでアプリがアクティブになった場合は[getInitialLink](https://rnfirebase.io/dynamic-links/usage#backgroundquit-events)でディープリンクのURLを取得します。

### アプリ起動中の受信

アプリがアクティブなときにディープリンクを開いた場合は[onLink](https://rnfirebase.io/dynamic-links/usage#foreground-events)

### URLパラメータの保持

URLパラメータはコンテキストに入れるとしてもアプリケーションのコンテキストには入れない。
パラメータで持ち回るか、共有すべきコンテキストを整理する。

- アカウント登録まで: Routesパラメータで受け渡し
  ログイン画面から新規登録画面までRoutesパラメータでディープリンクのURLを任意で設定する
- Homeタブ: 不要
- Teamタブ: チーム詳細のRoutesパラメータに設定

### iOSで受け取る

iOSではではユーザの操作でディープリンクを受信したかどうかを判定するために[matchType](https://firebase.google.com/docs/reference/swift/firebasedynamiclinks/api/reference/Enums/DLMatchType.html)でハンドリングできます。
matchTypeが`unique`でないリンクは破棄します。
